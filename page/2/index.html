<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    

    <!--Author-->
    
        <meta name="author" content="John Doe">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="c-an"/>
    

    <!--Open Graph Description-->
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="c-an"/>

    <!--Type page-->
    
        <meta property="og:type" content="website" />
    

    <!--Page Cover-->
    

    
        <meta name="twitter:card" content="summary" />
    
    
    

    <!-- Title -->
    
    <title>page - c-an</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/style.css">


    <!-- Google Analytics -->
    


<meta name="generator" content="Hexo 6.1.0"></head>


<body>

<div class="bg-gradient"></div>
<div class="bg-pattern"></div>

<!-- Menu -->
<!--Menu Links and Overlay-->
<div class="menu-bg">
    <div class="menu-container">
        <ul>
            
            <li class="menu-item">
                <a href="/">
                    Home
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/archives">
                    Archives
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/about.html">
                    About
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/tags">
                    Tags
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/categories">
                    Categories
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/contact.html">
                    Contact
                </a>
            </li>
            
        </ul>
    </div>
</div>

<!--Hamburger Icon-->
<nav>
    <a href="#menu"></a>
</nav>

<div class="container">

    <!-- Main Content -->
    <div class="row">
    <div class="col-sm-12">

        <!--Title and Logo-->
        <header>
    <div class="logo">
        <a href="/"><i class="logo-icon fa fa-cube" aria-hidden="true"></i></a>
        
            <h1 id="main-title" class="title">c-an</h1>
        
    </div>
</header>

        <section class="main">
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2022/04/30/%E4%BF%AE%E5%A4%8D%E6%9C%BA%E5%99%A8%E4%BA%BA%E8%84%9A%E6%9C%AC/">
                修复机器人脚本
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2022-04-30</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <p>发现一个问题，原先设置的时候是按c才发射飞盘，这并不方便，也不符合左手WASD，右手鼠标的习惯。所以要进行更改。</p>
<blockquote>
<p>更改按键设置：</p>
</blockquote>
<p>Edit&gt;Project Settings&gt;Input Manager(mouse 0是鼠标左键的意思)</p>
<p>好了，更改代码，到RubyController&gt;Update</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if(Input.GetKeyDowm(KeyCode.C)||Input.GetAxis(&quot;Fire1&quot;)) &#123;</span><br><span class="line">    Launch();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然而上面的代码报错了，因为Input.GetKeyDowm(KeyCode.C)是一个bool值，真或假，Input.GetAxis(“Fire1”)是鼠标左键按下获取到的一个整型值，是+-1。一般按下以后是1.0，未按下是0。所以一般不等于0，认为是按下了鼠标左键或leftCtrl<br><br></br><br>下面这样就可以了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if(Input.GetKeyDowm(KeyCode.C)||Input.GetAxis(&quot;Fire1&quot;)!=0) &#123;</span><br><span class="line">    Launch();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p>下面是正文，修复机器人</p>
<h1 id="修复机器人"><a href="#修复机器人" class="headerlink" title="修复机器人"></a>修复机器人</h1><p>目前飞弹在碰撞时只是销毁自身，但目标是用飞弹来修复损坏的机器人。</p>
<p>要修复机器人，执行以下操纵：</p>
<ol>
<li>要在Enemy脚本中编写函数，添加一个名为broken的bool变量，并将变量初始化未true，这样机器人一开始就是损坏的。</li>
<li>在Update函数的开头，添加一个测试用于检查机器人是否损坏。如果没有损坏则退出函数。</li>
</ol>
<p>修复后，机器人停止移动（就是bool值为false的时候，移动的代码失效）。由于这个原因，提前退出Update函数将导致机器人的代码停止执行。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//如果已修复机器人，则直接退出Update方法</span><br><span class="line">        //不再移动</span><br><span class="line">        if (!broked) &#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>把以上代码粘贴到Update和FixedUpdate里<br><br></br></p>
<p>下面是修复机器人</p>
<blockquote>
<p>在Projectile1里的碰撞事件方法里让飞弹来调用修复机器人的脚本<br>另外，还需要注意的地方是，不可以只在飞弹碰撞到碰撞体的时候才进行销毁，没有碰撞到也应该进行销毁，不然一直clone，游戏性能会非常差。这个更改应该写到Projectile1的Update里，Update检测比较方便</p>
</blockquote>
<p><br></br></p>
<p>下列是EnemyController2的代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line">public class EnemyController2 : MonoBehaviour &#123;</span><br><span class="line">    //代表移动速度（实际上是每次刷新时移动的距离）</span><br><span class="line">    public float speed;</span><br><span class="line">    //是否垂直移动，true按y轴移动，false按x轴移动</span><br><span class="line">    public bool vertical;</span><br><span class="line"></span><br><span class="line">    //声明刚体对象</span><br><span class="line">    //rigidbody2D先前我们已经用过了，如果不希望rigidbody2D被覆盖</span><br><span class="line">    //这里可以取比如rigidbody2d这种不一样的名字</span><br><span class="line">    Rigidbody2D rigidbody2d;</span><br><span class="line"></span><br><span class="line">    //朝一个方向移动的总时间</span><br><span class="line">    public float changeTime = 3.0f;</span><br><span class="line"></span><br><span class="line">    //计时器</span><br><span class="line">    float timer;</span><br><span class="line">    //方向</span><br><span class="line">    int direction = 1;</span><br><span class="line">    // Start is called before the first frame update</span><br><span class="line"></span><br><span class="line">    //在字段里面声明一个Animator,动画管理者组件</span><br><span class="line">    Animator animator;</span><br><span class="line"></span><br><span class="line">    //设定一个bool值，初始值代表机器人刚开始是“坏”的</span><br><span class="line">    bool broked = true;</span><br><span class="line"></span><br><span class="line">    void Start() &#123;</span><br><span class="line">        //通过当前这个代码组件，获取到这个代码组件所在的游戏对象</span><br><span class="line">        //再通过游戏对象，获取到刚体组件</span><br><span class="line">        rigidbody2d = GetComponent&lt;Rigidbody2D&gt;();</span><br><span class="line"></span><br><span class="line">        //游戏对象一般都是通过Start获取</span><br><span class="line">        rigidbody2d = GetComponent&lt;Rigidbody2D&gt;();</span><br><span class="line">        //计时器也要给它设置好</span><br><span class="line">        timer = changeTime;</span><br><span class="line">        //把Animator实例化，拿到脚本组件所挂接的游戏对象的Animator组件</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //Update本来是每帧来调用，但是和FixedUpdate结合使用，它又是固定的</span><br><span class="line">    void Update() &#123;</span><br><span class="line">        //如果已修复机器人，则直接退出Update方法</span><br><span class="line">        //不再移动</span><br><span class="line">        if (!broked) &#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        //每次减少</span><br><span class="line">        //但是每秒减少还是一样的</span><br><span class="line">        timer -= Time.deltaTime;</span><br><span class="line">        //如果timer到0，重置</span><br><span class="line">        if (timer &lt; 0) &#123;</span><br><span class="line">            //方向取反</span><br><span class="line">            direction = -direction;</span><br><span class="line">            //时间重置</span><br><span class="line">            timer = changeTime;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    //若是希望移动非常稳定的话，用FixedUpdate</span><br><span class="line">    private void FixedUpdate() &#123;</span><br><span class="line">        //如果已修复机器人，则直接退出Update方法</span><br><span class="line">        //不再移动</span><br><span class="line">        if (!broked) &#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        //获取当前游戏对象所在的位置</span><br><span class="line">        Vector2 position = rigidbody2d.position;</span><br><span class="line"></span><br><span class="line">        //纵向移动，沿y轴移动</span><br><span class="line">        //加不加Time.deltaTime都可以</span><br><span class="line">        if (vertical) &#123;</span><br><span class="line">            position.y = position.y + Time.deltaTime * speed*direction;</span><br><span class="line">            animator.SetFloat(&quot;Move X&quot;, 0);</span><br><span class="line">            animator.SetFloat(&quot;Move Y&quot;, direction);</span><br><span class="line">        &#125;</span><br><span class="line">        //否则，沿x轴移动</span><br><span class="line">         else &#123;</span><br><span class="line">            position.x = position.x + Time.deltaTime * speed*direction;</span><br><span class="line">            animator.SetFloat(&quot;Move X&quot;, direction);</span><br><span class="line">            animator.SetFloat(&quot;Move Y&quot;, 0);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        //和直接赋值的效果是一样的，但是这个更严谨些</span><br><span class="line">        rigidbody2d.MovePosition(position);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //刚体碰撞的方法</span><br><span class="line">    //在这个方法中，添加对玩家伤害的逻辑</span><br><span class="line">    private void OnCollisionEnter2D(Collision2D other) &#123;</span><br><span class="line">        //获取和敌人碰撞的玩家角色</span><br><span class="line">        //先获取玩家控制器脚本</span><br><span class="line">        //这个类的设置不能直接GetComponent</span><br><span class="line">        //要先获得gameObject</span><br><span class="line">        //这个是类设定的规则，记住这个方式来使用</span><br><span class="line">        RubyController rubyController = other.gameObject.GetComponent&lt;RubyController&gt;();</span><br><span class="line"></span><br><span class="line">        //如果不为空，直接让它减血</span><br><span class="line">        if (rubyController != null) &#123;</span><br><span class="line">            //玩家角色掉血</span><br><span class="line">            rubyController.ChangeHealth(-1);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //修复机器人的方法</span><br><span class="line">    //这个修复的脚本肯定是要别人来调用的，所以设置为public</span><br><span class="line">    //这里要调用修复的应该是飞弹，所以调用Fix写在飞弹的脚本里</span><br><span class="line">    public void Fix() &#123;</span><br><span class="line">        //更改状态为已经修复</span><br><span class="line">        broked = false;</span><br><span class="line">        //让机器人不会再碰撞</span><br><span class="line">        //这里采取的是刚体对象取消物理引擎效果</span><br><span class="line">        rigidbody2d.simulated = false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><br></br><br>下列是Projectile1的代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">//子弹预制件脚本</span><br><span class="line">public class Projectile1 : MonoBehaviour &#123;</span><br><span class="line">    //声明刚体对象</span><br><span class="line">    Rigidbody2D rigidbody2d;</span><br><span class="line">    // Start is called before the first frame update</span><br><span class="line">    void Awake() &#123;</span><br><span class="line">        //通过这个脚本对象获取当前游戏对象所绑定的刚体</span><br><span class="line">        //获取刚体对象实例</span><br><span class="line">        rigidbody2d = GetComponent&lt;Rigidbody2D&gt;();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">    private void Update() &#123;</span><br><span class="line">        //transform.position.magnitude是拿到飞弹飞出去的绝对长度</span><br><span class="line">        //如果没有碰到任何碰撞体，在飞行距离超过100单位后，自动销毁</span><br><span class="line">        if (transform.position.magnitude &gt; 100.0f) &#123;</span><br><span class="line">            Destroy(gameObject);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    //把当前的子弹抛射出去</span><br><span class="line">    //传入参数（方向，力）</span><br><span class="line">    public void Launch(Vector2 direction,float force) &#123;</span><br><span class="line">        //这次不使用移动，使用物理系统</span><br><span class="line">        //通过刚体对象调用物理系统的AddForce方法</span><br><span class="line">        //对游戏对象施加一个力，使其移动</span><br><span class="line">        rigidbody2d.AddForce(direction*force);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //碰撞事件方法</span><br><span class="line">    private void OnCollisionEnter2D(Collision2D collision) &#123;</span><br><span class="line">        //获取齿轮飞弹碰撞到机器人对象的脚本组件</span><br><span class="line">        EnemyController2 enemyController2 = collision.collider.GetComponent&lt;EnemyController2&gt;();</span><br><span class="line">        //如果获取到不为空</span><br><span class="line">        if(enemyController2!=null) &#123;</span><br><span class="line">            enemyController2.Fix();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        //向控制台输出信息，打印出当前子弹碰撞的游戏对象是谁</span><br><span class="line">        Debug.Log($&quot;齿轮子弹碰撞到了：&#123;collision.gameObject&#125;&quot;);</span><br><span class="line">        //碰撞完后，子弹应该消失，即销毁当前子弹游戏对象</span><br><span class="line">        Destroy(gameObject);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2022/04/27/%E4%B8%96%E7%95%8C%E4%BA%A4%E4%BA%92-%E9%A3%9E%E5%BC%B9/">
                世界交互-飞弹
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2022-04-27</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <h1 id="飞弹预制件及脚本"><a href="#飞弹预制件及脚本" class="headerlink" title="飞弹预制件及脚本"></a>飞弹预制件及脚本</h1><p>tip:本文子弹等同于飞弹</p>
<p>我在Sprites里拖拽素材到场景中发现飞弹太大了，Pixels Per Unit（一个单元格内用多少像素来绘制图像，如果你希望它没那么精细，可以把值改小一点，这样图形绘制的面积就会大一些了）由100改成500比较合适。</p>
<p>我们必须要把刚刚拖出来的飞盘制作成预制件才可以使用。为什么呢？因为攻击时要用很多的飞弹，每个飞弹不可能每次都去创建。</p>
<p>把素材拖拽到Perfabs里，让它称为预制件</p>
<p>这个预制件是通过代码生成的，就是按键盘上的某个键，创建这个建的游戏对象，然后发射这个游戏对象作为一个飞弹</p>
<p>既然能够飞出去并且还能发生碰撞，那么我们在修改预制件的时候，应该有刚体和碰撞体。添加Rigidbody 2D（记得把重力取消了，不需要那么真实，平飞就行）和Box Collider 2D</p>
<p>下面是子弹预制件脚本代码（写在Projectilr1.cs）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">//子弹预制件脚本</span><br><span class="line">public class Projectile1 : MonoBehaviour &#123;</span><br><span class="line">    //声明刚体对象</span><br><span class="line">    Rigidbody2D rigidbody2d;</span><br><span class="line">    // Start is called before the first frame update</span><br><span class="line">    void Start() &#123;</span><br><span class="line">        //通过这个脚本对象获取当前游戏对象所绑定的刚体</span><br><span class="line">        //获取刚体对象实例</span><br><span class="line">        rigidbody2d = GetComponent&lt;Rigidbody2D&gt;();</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">    //把当前的子弹抛射出去</span><br><span class="line">    //传入参数（方向，力）</span><br><span class="line">     public void Launch(Vector2 direction,float force) &#123;</span><br><span class="line">        //这次不使用移动，使用物理系统</span><br><span class="line">        //通过刚体对象调用物理系统的AddForce方法</span><br><span class="line">        //对游戏对象施加一个力，使其移动</span><br><span class="line">        rigidbody2d.AddForce(direction*force);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //碰撞事件方法</span><br><span class="line">    private void OnCollisionEnter2D(Collision2D collision) &#123;</span><br><span class="line">        //向控制台输出信息，打印出当前子弹碰撞的游戏对象是谁</span><br><span class="line">        Debug.Log($&quot;齿轮子弹碰撞到了：&#123;collision.gameObject&#125;&quot;);</span><br><span class="line">        //碰撞完后，子弹应该消失，即销毁当前子弹游戏对象</span><br><span class="line">        Destroy(gameObject);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><br></br></p>
<h1 id="玩家发射飞弹脚本"><a href="#玩家发射飞弹脚本" class="headerlink" title="玩家发射飞弹脚本"></a>玩家发射飞弹脚本</h1><p>发射预制件是由玩家角色发射的，所以应该在（Ruby）的脚本中写入（发射飞弹）</p>
<ul>
<li>玩家角色创建游戏对象（子弹）</li>
<li>并把它发射出去</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//声明一个公开的游戏对象projectilePrefab，用来获取子弹预制件对象</span><br><span class="line">//把它设置为公开是为了在Unity里把Ruby和子弹关联起来了</span><br><span class="line">public GameObject projectilePrefab;</span><br></pre></td></tr></table></figure>
<p><br></br></p>
<blockquote>
<p>在Unity的Ruby Controller（Script）能看到刚添加的Projectile Prefab，在这里，把子弹预制件挂上去。（在Select GameObject里搜就行了，默认是Scence，选择Assets，挂接Projectile）。</p>
</blockquote>
<blockquote>
<p>挂接上了，就可以拿到所挂的预制件，用代码生成这个预制件的游戏对象（在这就是不停生成子弹）</p>
</blockquote>
<blockquote>
<p>获取到子弹以后就需要有一个发射子弹的方法，并且调用子弹的发射</p>
</blockquote>
<blockquote>
<p>发射，如何发射？需要获取玩家的输入，玩家的输入添加在update里</p>
</blockquote>
<p>下列是玩家发射飞弹脚本代码（写在RubyCintroller.cs）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line">public class RubyController : MonoBehaviour &#123;</span><br><span class="line">    //声明一个公开的游戏对象projectilePrefab，用来获取子弹预制件对象</span><br><span class="line">    //把它设置为公开是为了在Unity里把Ruby和子弹关联起来了</span><br><span class="line">    public GameObject projectilePrefab;</span><br><span class="line">    //设置玩家间隔无敌时间</span><br><span class="line">    public float timeInvincible = 2.0f;</span><br><span class="line">    //设置是否无敌的变量</span><br><span class="line">    bool isInvincible;</span><br><span class="line">    //定义变量，进行无敌时间的计时，无敌时间计时器</span><br><span class="line">    float invincibleTimer;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    //设置最大生命值（生命上限）</span><br><span class="line">    public int maxHealth = 5;</span><br><span class="line">    //设置当前生命值的属性health</span><br><span class="line"></span><br><span class="line">    //c#中支持面向对象程序设计中的封装概念，对数据成员的保护</span><br><span class="line">    //数据成员变量，默认一般都应该设置为私有，只能通过对当前类的方法或属性进行访问</span><br><span class="line">    //属性类似于特殊的函数结构，它get是一个关键字</span><br><span class="line">    //get是获取当前属性所绑定的字段的值</span><br><span class="line">    //属性相当于一个盒子，字段是在盒子里的某件东西</span><br><span class="line">    //属性限制了字段的访问规则，比如只能读或写</span><br><span class="line">    //或者读写的时候满足某种需求，才能往外进行操作</span><br><span class="line">    //相当于把它包装起来，这就称为封装</span><br><span class="line">    //属性是公有的，可以通过取值器get、赋值器set设定对应字段的访问规则，满足规则才能进行访问</span><br><span class="line"></span><br><span class="line">    public int health &#123; </span><br><span class="line">        get &#123; return currentHealth; &#125;</span><br><span class="line">        //set &#123; currentHealth = value; &#125;//可赋值</span><br><span class="line">    &#125;</span><br><span class="line">    int currentHealth;</span><br><span class="line"></span><br><span class="line">    //声明刚体对象</span><br><span class="line">    Rigidbody2D rigidbody2D;</span><br><span class="line">    //获取用户输入</span><br><span class="line">    float horizontal;</span><br><span class="line">    float vertical;</span><br><span class="line"></span><br><span class="line">    //将速度暴露出来，使其可调</span><br><span class="line">    public float speed = 0.1f;</span><br><span class="line"></span><br><span class="line">    //声明一个动画管理者组件对象</span><br><span class="line">    Animator animator;</span><br><span class="line">    //创建一个二维矢量，用来存储Ruby静止不动时看的方向（即面向的方向）</span><br><span class="line">    //与机器人相比，Ruby可以站立不动。她站立不动时，Move X和Y均为0，这时状态机就没法获取Ruby静止时的朝向</span><br><span class="line">    //所以需要手动设置一个</span><br><span class="line">    Vector2 lookDirection = new Vector2(1, 0);</span><br><span class="line">    //移动二维矢量</span><br><span class="line">    Vector2 move;</span><br><span class="line"></span><br><span class="line">    private void Start() &#123;</span><br><span class="line">        //获取当前游戏对象的刚体组件</span><br><span class="line">        rigidbody2D = GetComponent&lt;Rigidbody2D&gt;();</span><br><span class="line">        //游戏刚开始，玩家满血</span><br><span class="line">        currentHealth = maxHealth;</span><br><span class="line"></span><br><span class="line">        //获取组件对象</span><br><span class="line">        animator = GetComponent&lt;Animator&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // Update is called once per frame</span><br><span class="line">    //每帧调用一次Update</span><br><span class="line">    //让游戏对象每帧右移0.1</span><br><span class="line">    void Update() &#123;</span><br><span class="line">        //获取水平输入，按向左，会获得-1.0f；按向右，会获得1.0f</span><br><span class="line">        horizontal = Input.GetAxis(&quot;Horizontal&quot;);</span><br><span class="line">        //获取垂直输入，按向下，会获得-1.0f；按向上，会获得1.0f</span><br><span class="line">        vertical = Input.GetAxis(&quot;Vertical&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        //判断是否处于无敌状态，来进行计时器的倒计时</span><br><span class="line">        if (isInvincible) &#123;</span><br><span class="line">            //每次Update减去一帧消耗的时间</span><br><span class="line">            invincibleTimer = invincibleTimer - Time.deltaTime;</span><br><span class="line">            if (invincibleTimer &lt; 0) &#123;</span><br><span class="line">                isInvincible = false;//无敌时间小于0了，让它不无敌了</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        //创建一个二维矢量对象来表示Ruby移动的数据信息</span><br><span class="line">        move = new Vector2(horizontal, vertical);</span><br><span class="line">        //如果move中的x/y不为零，表示正在移动</span><br><span class="line">        //将ruby面向方向设置为移动方向</span><br><span class="line">        //停止移动，保持以前方向，所以这个if结构用于转向时重新赋值面向方向</span><br><span class="line">        //if条件表示正在移动</span><br><span class="line">        if (!Mathf.Approximately(move.x, 0.0f) || !Mathf.Approximately(move.y, 0.0f)&#123;</span><br><span class="line">            ////将ruby面向方向设置为移动方向（ruby朝向移动方向）</span><br><span class="line">            lookDirection.Set(move.x, move.y);//lookDirection.x=move.x  lookDirection.y=move.y</span><br><span class="line"></span><br><span class="line">            //使向量长度为1，可以将此方法称为向量的“归一化”方法</span><br><span class="line">            //通常在表示方向，而非位置的方向上</span><br><span class="line">            //因为blend tree中表示方向的参数值的取值方位是-1.0到1.0，</span><br><span class="line">            //所以一般用向量作为Animator.SetFloat方法的参数时，一般要对向量先进行“归一化”处理</span><br><span class="line">            lookDirection.Normalize();//lookDirection在这里只表示方向</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        //传递Ruby面朝方向给blend tree</span><br><span class="line">        animator.SetFloat(&quot;Look X&quot;, lookDirection.x);</span><br><span class="line">        animator.SetFloat(&quot;Look Y&quot;, lookDirection.y);</span><br><span class="line">        //传递Ruby速度给blend tree</span><br><span class="line">        //矢量的magnitue属性，用来返回矢量的长度,是一个绝对值</span><br><span class="line">        animator.SetFloat(&quot;Speed&quot;, move.magnitude);</span><br><span class="line"></span><br><span class="line">        //添加发射子弹的逻辑</span><br><span class="line">        //KeyCode.C 指和键盘C上的键对应</span><br><span class="line">        if (Input.GetKeyDown(KeyCode.C)) &#123;</span><br><span class="line">            //调用发射</span><br><span class="line">            Launch();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //固定时间间隔执行的更新方法</span><br><span class="line">    private void FixedUpdate() &#123;</span><br><span class="line">        //获取当前对象位置</span><br><span class="line">        Vector2 position = transform.position;</span><br><span class="line">        //更改位置</span><br><span class="line">        position.x = position.x + 0.1f * horizontal;</span><br><span class="line">        position.y = position.y + 0.1f * vertical;</span><br><span class="line">        //新位置给游戏参数</span><br><span class="line">        rigidbody2D.position = position;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //不是系统函数，自定义来更改生命值的</span><br><span class="line">    public void ChangeHealth(int amount) &#123;</span><br><span class="line">        //假设玩家受伤害的时间间隔是2秒</span><br><span class="line">        //不管是什么样的伤害，只要amount小于0，就判断是不是无敌</span><br><span class="line">        if (amount &lt; 0) &#123;</span><br><span class="line">            //判断当前是否处于无敌状态</span><br><span class="line">            if (isInvincible) &#123;</span><br><span class="line">                //无敌不伤血，跳出无敌状态</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        //当不是无敌状态时，会执行下面的代码</span><br><span class="line">        //重置无敌状态为真</span><br><span class="line">        isInvincible = true;</span><br><span class="line">        //设置无敌时间</span><br><span class="line">        invincibleTimer = timeInvincible;</span><br><span class="line"></span><br><span class="line">        //播放受伤动画</span><br><span class="line">        animator.SetTrigger(&quot;Hit&quot;);</span><br><span class="line">        //系统函数Clamp，用于限制取值范围的函数</span><br><span class="line">        //0~最大生命值</span><br><span class="line">        currentHealth = Mathf.Clamp(currentHealth + amount, 0, maxHealth);</span><br><span class="line">        //在控制台输出生命信息</span><br><span class="line">        Debug.Log(&quot;当前生命值：&quot; + currentHealth + &quot;/&quot; + maxHealth);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //游戏对象发子弹的方法，不需要任何的参数</span><br><span class="line">    void Launch() &#123;</span><br><span class="line">        //创建子弹游戏对象</span><br><span class="line">        //如果要调用这个Launch，子弹就出来了</span><br><span class="line">        //Instantiate()是Unity自带的一个方法,用来实例化一个对象</span><br><span class="line">        //第一个参数是实例化对象用到的预制件</span><br><span class="line">        //这里实例化对象要用到的预制件应该是传递过来的projectilePrefab</span><br><span class="line">        //第二个参数是起始位置，经过计算应该是Ruby手的位置(身高的一半)</span><br><span class="line">        //Quaternion.identity不要旋转</span><br><span class="line">        GameObject projectileObject = Instantiate(projectilePrefab, rigidbody2D.position + Vector2.up * 0.5f, Quaternion.identity);</span><br><span class="line">        //调整子弹的飞行，不能让它每次出来以后都是静止的</span><br><span class="line">        //要调用Projectile控制器组件，Projectile脚本组件本身也是一个类</span><br><span class="line">        //调用子弹里的Launch，这个Launch能让子弹向指定的方向移动</span><br><span class="line">        //先通过游戏对象get当前这个脚本组件</span><br><span class="line">        //get到以后就能用子弹里的Launch方法</span><br><span class="line">        Projectile1 projectile = projectileObject.GetComponent&lt;Projectile1&gt;();</span><br><span class="line">        //通过脚本组件调用子弹移动方向</span><br><span class="line">        //第一个参数是移动的方向，取的是玩家面朝的方向</span><br><span class="line">        //第二个参数是力，如果先要速度快些，可以加大</span><br><span class="line">        projectile.Launch(lookDirection, 300);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="关于Unity与vs019的调试"><a href="#关于Unity与vs019的调试" class="headerlink" title="关于Unity与vs019的调试"></a>关于Unity与vs019的调试</h3><p>打完断点后，在vs里开始附加到Unity（前提是Edit&gt;Preferences&gt;External Tools&gt;External Script Editor绑定了）,编辑器卡住，不再往下运行。一般查看局部变量就行，如果要查看某个值的话，在监视里自己添加。</p>
<p>调试的过程中，我们发现projectile中的rigidbldy2d是空的，没有刚体对象，不能AddForce，没法往外发射</p>
<h1 id="修复错误行"><a href="#修复错误行" class="headerlink" title="修复错误行"></a>修复错误行</h1><p>上述代码运行后，控制台有两个错误行</p>
<ul>
<li>1.null 引用异常</li>
</ul>
<p>双击null引用异常错误，会打卡Projectile脚本并定位到Rigidbody2d.AddForce(direction*force)行，这表示尽管我梦在Start中获得了刚体，但Rigidbody2d变量还是为空（包含null）。</p>
<p>这是因为在创建对象时，Unity不会允许Start，而是在下一帧才开始运行。因此，在飞弹上调用Launch时，只实例化（Instantiate），不调用Start，因此Rigidbody2d仍然为空。要解决此问题，请将Projectile（我的是Projectile1）脚本中的void Start（）函数重命名为void Awake（）。</p>
<blockquote>
<p>与Start刚好相反，在创建对象时（调用Instantile时）就会立即调用Awake，因此在调用Launch之间前已经正确初始化Rigidbody2d</p>
</blockquote>
<blockquote>
<p>tip:在Unity游戏程序运行时，所有附加到游戏对象上的脚本组件都会运行<br>Awake方法和Start方法都只会运行一次，多用于数据初始化。这两个方法的执行顺序是：先执行Awake方法，再执行Start方法，最后才是Update（）</p>
</blockquote>
<ul>
<li>2.飞弹与Ruby发生了碰撞</li>
</ul>
<p>因为飞弹是在Ruby上创建的飞弹。一旦创建，物理系统就会告知，飞弹刚体正在与Ruby碰撞体碰撞。然后再OnCollisitionEnter函数中调用Destroy，立刻销毁飞弹。</p>
<p>为了测试一下飞弹是否与Ruby碰撞，不销毁飞弹。但是又会遇到一个问题，那就是碰撞后会立刻停止移动。<br><br></br></p>
<h1 id="图层和碰撞"><a href="#图层和碰撞" class="headerlink" title="图层和碰撞"></a>图层和碰撞</h1><p>要修复这个问题，正确方法是使用图层，图层可以讲游戏对象分组在一起，以便可以对它们就行筛选。现在的目标是创建一个角色图层来放入Ruby游戏对象，然后创建一个飞弹图层来放入所以飞弹。</p>
<p>然后告诉物理系统，角色图层和飞弹图层不能碰撞，要物理系统忽略这些图层中的对象之间的所有碰撞。</p>
<ul>
<li><p>1.要查看某个游戏对象在哪个图层，单击游戏对象Inspector右上角的Layers下拉选单。所有对象都从Default层开始（即图层编号为0）.游戏最多可以包含32个不同的图层。</p>
</li>
<li><p>2.更改游戏对象的图层后，还需要在项目配置（Project Settings）里的Physics 2D里的Projectile和Character之间的对勾取消选择，这表示它们不会互相碰撞。这些横向和纵向都代表图层。</p>
</li>
</ul>
<hr>
<p><br></br><br>^_^<br><br></br></p>
<hr>
<p>以上修改完就Ruby就可以正常发射飞弹了，但是似乎还没挂接发射飞弹的动作，只需要在RubyController的末尾中添加一句代码就行了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"> void Launch() &#123;</span><br><span class="line">        //创建子弹游戏对象</span><br><span class="line">        //如果要调用这个Launch，子弹就出来了</span><br><span class="line">        //Instantiate()是Unity自带的一个方法,用来实例化一个对象</span><br><span class="line">        //第一个参数是实例化对象用到的预制件</span><br><span class="line">        //这里实例化对象要用到的预制件应该是传递过来的projectilePrefab</span><br><span class="line">        //第二个参数是起始位置，经过计算应该是Ruby手的位置(身高的一半)</span><br><span class="line">        //Quaternion.identity不要旋转</span><br><span class="line">        GameObject projectileObject = Instantiate(projectilePrefab, rigidbody2D.position + Vector2.up * 0.5f, Quaternion.identity);</span><br><span class="line">        //调整子弹的飞行，不能让它每次出来以后都是静止的</span><br><span class="line">        //要调用Projectile控制器组件，Projectile脚本组件本身也是一个类</span><br><span class="line">        //调用子弹里的Launch，这个Launch能让子弹向指定的方向移动</span><br><span class="line">        //先通过游戏对象get当前这个脚本组件</span><br><span class="line">        //get到以后就能用子弹里的Launch方法</span><br><span class="line">        Projectile1 projectile = projectileObject.GetComponent&lt;Projectile1&gt;();</span><br><span class="line">        //通过脚本组件调用子弹移动方向</span><br><span class="line">        //第一个参数是移动的方向，取的是玩家面朝的方向</span><br><span class="line">        //第二个参数是力，如果先要速度快些，可以加大</span><br><span class="line">        projectile.Launch(lookDirection, 300);</span><br><span class="line"></span><br><span class="line">        //把SetTrigger参数输进去就行了，它会自动挂接</span><br><span class="line">        //在Launch这个状态下能接收到这个参数，激活Launch状态</span><br><span class="line">        animator.SetTrigger(&quot;Launch&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2022/04/27/2D%E7%B2%BE%E7%81%B5%E5%8A%A8%E7%94%BB%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93/">
                2D精灵动画使用总结
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2022-04-27</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <h1 id="动画术语"><a href="#动画术语" class="headerlink" title="动画术语"></a>动画术语</h1><h2 id="动画剪辑术语"><a href="#动画剪辑术语" class="headerlink" title="动画剪辑术语"></a>动画剪辑术语</h2><ul>
<li>动画剪辑（Animation Clip）：可用于动画角色或简单动画数据。这是一种简单的单位动作，例如“空闲”、“行走”、“奔跑”</li>
<li>动画曲线（Animation Curves）：曲线可以附加到动画剪辑，并由游戏中的各种参数控制</li>
<li>Avatar遮罩（Avatar Mask）：为骨架指定要包含或排除哪些身体部位，在动画层或导入器中使用。</li>
</ul>
<h2 id="Animator和Animator-Controller术语"><a href="#Animator和Animator-Controller术语" class="headerlink" title="Animator和Animator Controller术语"></a>Animator和Animator Controller术语</h2><ul>
<li>Animator组件（Animator Component）：相关动画的东西都是通过这个组件来进行同一的管理，来挂接到游戏对象上</li>
<li>Animator Controller：是真正用来管理动画素材的。把Animator Controller放到Animator组件上，整个系统就挂接到一起了。用来控制不同状态下动画的播放，以及状态间的转换。 </li>
<li>Animator窗口（Animator Window）</li>
<li>动画状态机（Animation State Machine）</li>
<li>动画参数（Animation Blend Tree）</li>
</ul>
<blockquote>
<p>Animator&gt;Parameters-&gt;”+”,有些时候Trigger比Bool更好用，Bool进入一个区域后出来要更改Bool值来改变状态，而Tigger不<br>可以根据时间或参数来决定状态转换。如果勾选了Has Exit Time，Exit Time的值也可以更改了，这时就是根据时间来进行状态转换的条件。这时即使没有在Conditions设置转换条件，到达退出时间，会自动退出当前模式</p>
</blockquote>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2022/04/27/%E5%88%B6%E4%BD%9C%E5%8A%A8%E7%94%BB%E7%8A%B6%E6%80%81%E8%BD%AC%E6%8D%A2/">
                制作动画状态转换
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2022-04-27</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <blockquote>
<p>复刻动画状态的转换，肯定要先看源码。选择已经做好的Ruby的Animator，看关于Idle和Moving之间的转变。<br>点击Idle，Idle-&gt;Moving有个Has Exit Time，取消勾选，会立马转变</p>
</blockquote>
<blockquote>
<p>关于新词汇：</p>
</blockquote>
<ul>
<li>Fixed Duration</li>
</ul>
<p>解释：如果选中Fixed Duration复选框，则以秒为单位解读过渡时间。如果未选中Fixed Duration复选框，则过渡的时间解读未源状态的标准化时间的一部分。（没懂）</p>
<ul>
<li>Transition Duration（s）  对当前状态持续时间的过渡时间，以标准化或秒为单位（具体取决于Fixed Duration模式），慢慢渐变的一个过程，此时间在过渡图中显示为两个蓝色标记之间的部分，0代表没有重叠。</li>
<li>Transition Offset        过渡到目标状态的起始播放的时间偏移。例如，值为0.5表示目标状态在其时间轴的50%出开始播放。</li>
<li>Interruption Source      影响它的源</li>
<li>BlendTree Parameters&gt; Conditions ，那个框满足它什么条件进行转换。</li>
</ul>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2022/04/26/%E5%85%B3%E4%BA%8E%E7%8E%A9%E5%AE%B6%E8%A7%92%E8%89%B2%E7%9A%84%E5%8A%A8%E7%94%BB%E5%88%B6%E4%BD%9C/">
                关于玩家角色的动画制作
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2022-04-26</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <h1 id="Use-the-Task-List"><a href="#Use-the-Task-List" class="headerlink" title="Use the Task List"></a>Use the Task List</h1><p>在vs里，写代码不知道做什么，可以先写TODO<br>例如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//TODO: 1.创建Animator和相关的数据对象</span><br><span class="line">//TODO: 2.传值，把Animator controller中Blend tree要用的参数传过去</span><br><span class="line">//3个不同的状态：idle move hit</span><br></pre></td></tr></table></figure>
<blockquote>
<p>任务列表的快捷键：ctrl + \ + t</p>
</blockquote>
<p><br></br></p>
<h1 id="添加Ruby动画控制脚本"><a href="#添加Ruby动画控制脚本" class="headerlink" title="添加Ruby动画控制脚本"></a>添加Ruby动画控制脚本</h1><h4 id="新词汇："><a href="#新词汇：" class="headerlink" title="新词汇："></a>新词汇：</h4><ul>
<li>Mathf 是Unity里用来做数学计算的库</li>
<li>approximately 英语里是大约的意思</li>
<li>Mathf.Approximately<br>  public static bool Approximately(float a,float b);<br>  使用Mathf.Approximately而不是&#x3D;&#x3D;，是因为计算机储存浮点数的方式意味着精度会有很小的损失<br>  描述：比较两个浮点值，如果它们相似（之间的差值处于较小值Epsilon范围内），返回true</li>
</ul>
<blockquote>
<p>Normalize()归一化 （opencv）<br><br></br></p>
</blockquote>
<ul>
<li>magnitude 表示数值的意思<blockquote>
<p>下面是添加Ruby动画控制脚本的完整代码</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line">public class RubyController : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    //设置玩家间隔无敌时间</span><br><span class="line">    public float timeInvincible = 2.0f;</span><br><span class="line">    //设置是否无敌的变量</span><br><span class="line">    bool isInvincible;</span><br><span class="line">    //定义变量，进行无敌时间的计时，无敌时间计时器</span><br><span class="line">    float invincibleTimer;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    //设置最大生命值（生命上限）</span><br><span class="line">    public int maxHealth = 5;</span><br><span class="line">    //设置当前生命值的属性health</span><br><span class="line"></span><br><span class="line">    //c#中支持面向对象程序设计中的封装概念，对数据成员的保护</span><br><span class="line">    //数据成员变量，默认一般都应该设置为私有，只能通过对当前类的方法或属性进行访问</span><br><span class="line">    //属性类似于特殊的函数结构，它get是一个关键字</span><br><span class="line">    //get是获取当前属性所绑定的字段的值</span><br><span class="line">    //属性相当于一个盒子，字段是在盒子里的某件东西</span><br><span class="line">    //属性限制了字段的访问规则，比如只能读或写</span><br><span class="line">    //或者读写的时候满足某种需求，才能往外进行操作</span><br><span class="line">    //相当于把它包装起来，这就称为封装</span><br><span class="line">    //属性是公有的，可以通过取值器get、赋值器set设定对应字段的访问规则，满足规则才能进行访问</span><br><span class="line"></span><br><span class="line">    public int health &#123; </span><br><span class="line">        get &#123; return currentHealth; &#125;</span><br><span class="line">        //set &#123; currentHealth = value; &#125;//可赋值</span><br><span class="line">    &#125;</span><br><span class="line">    int currentHealth;</span><br><span class="line"></span><br><span class="line">    //声明刚体对象</span><br><span class="line">    Rigidbody2D rigidbody2D;</span><br><span class="line">    //获取用户输入</span><br><span class="line">    float horizontal;</span><br><span class="line">    float vertical;</span><br><span class="line"></span><br><span class="line">    //将速度暴露出来，使其可调</span><br><span class="line">    public float speed = 0.1f;</span><br><span class="line"></span><br><span class="line">    //声明一个动画管理者组件对象</span><br><span class="line">    Animator animator;</span><br><span class="line">    //创建一个二维矢量，用来存储Ruby静止不动时看的方向（即面向的方向）</span><br><span class="line">    //与机器人相比，Ruby可以站立不动。她站立不动时，Move X和Y均为0，这时状态机就没法获取Ruby静止时的朝向</span><br><span class="line">    //所以需要手动设置一个</span><br><span class="line">    Vector2 lookDirection = new Vector2(1, 0);</span><br><span class="line">    //移动二维矢量</span><br><span class="line">    Vector2 move;</span><br><span class="line"></span><br><span class="line">    private void Start() &#123;</span><br><span class="line">        //获取当前游戏对象的刚体组件</span><br><span class="line">        rigidbody2D = GetComponent&lt;Rigidbody2D&gt;();</span><br><span class="line">        //游戏刚开始，玩家满血</span><br><span class="line">        currentHealth = maxHealth;</span><br><span class="line"></span><br><span class="line">        //获取组件对象</span><br><span class="line">        animator = GetComponent&lt;Animator&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // Update is called once per frame</span><br><span class="line">    //每帧调用一次Update</span><br><span class="line">    //让游戏对象每帧右移0.1</span><br><span class="line">    void Update() &#123;</span><br><span class="line">        //获取水平输入，按向左，会获得-1.0f；按向右，会获得1.0f</span><br><span class="line">        horizontal = Input.GetAxis(&quot;Horizontal&quot;);</span><br><span class="line">        //获取垂直输入，按向下，会获得-1.0f；按向上，会获得1.0f</span><br><span class="line">        vertical = Input.GetAxis(&quot;Vertical&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        //判断是否处于无敌状态，来进行计时器的倒计时</span><br><span class="line">        if (isInvincible) &#123;</span><br><span class="line">            //每次Update减去一帧消耗的时间</span><br><span class="line">            invincibleTimer = invincibleTimer - Time.deltaTime;</span><br><span class="line">            if (invincibleTimer &lt; 0) &#123;</span><br><span class="line">                isInvincible = false;//无敌时间小于0了，让它不无敌了</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        //创建一个二维矢量对象来表示Ruby移动的数据信息</span><br><span class="line">        move = new Vector2(horizontal, vertical);</span><br><span class="line">        //如果move中的x/y不为零，表示正在移动</span><br><span class="line">        //将ruby面向方向设置为移动方向</span><br><span class="line">        //停止移动，保持以前方向，所以这个if结构用于转向时重新赋值面向方向</span><br><span class="line">        //if条件表示正在移动</span><br><span class="line">        if (!Mathf.Approximately(move.x, 0.0f) || !Mathf.Approximately(move.y, 0.0f)&#123;</span><br><span class="line">            ////将ruby面向方向设置为移动方向（ruby朝向移动方向）</span><br><span class="line">            lookDirection.Set(move.x, move.y);//lookDirection.x=move.x  lookDirection.y=move.y</span><br><span class="line"></span><br><span class="line">            //使向量长度为1，可以将此方法称为向量的“归一化”方法</span><br><span class="line">            //通常在表示方向，而非位置的方向上</span><br><span class="line">            //因为blend tree中表示方向的参数值的取值方位是-1.0到1.0，</span><br><span class="line">            //所以一般用向量作为Animator.SetFloat方法的参数时，一般要对向量先进行“归一化”处理</span><br><span class="line">            lookDirection.Normalize();//lookDirection在这里只表示方向</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        //传递Ruby面朝方向给blend tree</span><br><span class="line">        animator.SetFloat(&quot;Look X&quot;, lookDirection.x);</span><br><span class="line">        animator.SetFloat(&quot;Look Y&quot;, lookDirection.y);</span><br><span class="line">        //传递Ruby速度给blend tree</span><br><span class="line">        //矢量的magnitue属性，用来返回矢量的长度,是一个绝对值</span><br><span class="line">        animator.SetFloat(&quot;Speed&quot;, move.magnitude);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //固定时间间隔执行的更新方法</span><br><span class="line">    private void FixedUpdate() &#123;</span><br><span class="line">        //获取当前对象位置</span><br><span class="line">        Vector2 position = transform.position;</span><br><span class="line">        //更改位置</span><br><span class="line">        position.x = position.x + 0.1f * horizontal;</span><br><span class="line">        position.y = position.y + 0.1f * vertical;</span><br><span class="line">        //新位置给游戏参数</span><br><span class="line">        rigidbody2D.position = position;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //不是系统函数，自定义来更改生命值的</span><br><span class="line">    public void ChangeHealth(int amount) &#123;</span><br><span class="line">        //假设玩家受伤害的时间间隔是2秒</span><br><span class="line">        //不管是什么样的伤害，只要amount小于0，就判断是不是无敌</span><br><span class="line">        if (amount &lt; 0) &#123;</span><br><span class="line">            //判断当前是否处于无敌状态</span><br><span class="line">            if (isInvincible) &#123;</span><br><span class="line">                //无敌不伤血，跳出无敌状态</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        //当不是无敌状态时，会执行下面的代码</span><br><span class="line">        //重置无敌状态为真</span><br><span class="line">        isInvincible = true;</span><br><span class="line">        //设置无敌时间</span><br><span class="line">        invincibleTimer = timeInvincible;</span><br><span class="line"></span><br><span class="line">        //播放受伤动画</span><br><span class="line">        animator.SetTrigger(&quot;Hit&quot;);</span><br><span class="line">        //系统函数Clamp，用于限制取值范围的函数</span><br><span class="line">        //0~最大生命值</span><br><span class="line">        currentHealth = Mathf.Clamp(currentHealth + amount, 0, maxHealth);</span><br><span class="line">        //在控制台输出生命信息</span><br><span class="line">        Debug.Log(&quot;当前生命值：&quot; + currentHealth + &quot;/&quot; + maxHealth);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><br></br></p>
</li>
</ul>
<h1 id="制作Ruby移动状态下用到的动画剪辑"><a href="#制作Ruby移动状态下用到的动画剪辑" class="headerlink" title="制作Ruby移动状态下用到的动画剪辑"></a>制作Ruby移动状态下用到的动画剪辑</h1><blockquote>
<p>tip：在新建玩家动画剪辑的时候，会自动生成一个管理动画剪辑的动画控制器。即在为游戏对象创建动画剪辑的时候，会自动生成一个和游戏对象同名的Controller。并且会把Animator挂到当前这个游戏对象上，相当于自动了，非常方便。（其实这样不好，但是这里是为了自己方便）</p>
</blockquote>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2022/04/25/%E7%B2%BE%E7%81%B5%E5%8A%A8%E7%94%BB/">
                精灵动画
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2022-04-25</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <h1 id="添加动画剪辑"><a href="#添加动画剪辑" class="headerlink" title="添加动画剪辑"></a>添加动画剪辑</h1><ul>
<li>Avatar:</li>
</ul>
<p>Unity动画系统Mecanim中的简化骨骼结构和3d素材中实际骨骼间建立的映射，称为Avatar（替身）</p>
<ul>
<li>动画剪辑（Animation clip）</li>
</ul>
<p>动画剪辑（Animation clip）是动画的基本组成部分，包含某些对象应如何随时改变其位置、旋转或其他相关信息。</p>
<p>动画剪辑一般和不同的状态相挂接。比如“静止状态”挂接站立不动的动画、“奔跑状态”挂接奔跑的动画…</p>
<ul>
<li>Animator Controller<br> Animator Controller用来控制不同状态下动画的播放，以及状态间的转换</li>
</ul>
<blockquote>
<p>以上三个部分（Avatar、动画剪辑和Animator Controller）都通过Animator组件一起附加到某个游戏对象上</p>
</blockquote>
<p>下面开始添加动画剪辑</p>
<blockquote>
<p>建立控制器（creat&gt;Animator Controller 记得创建一个Animations的文件夹方便管理），命名为Robot</p>
</blockquote>
<p>以Robot为例</p>
<ul>
<li>添加Animator组件，在Controller中把刚刚创建的Robot挂上去</li>
<li>打开预制件（Prefabs&gt;选中 双击）</li>
<li>Window&gt;Animation&gt;Animation(ctrl+6),要选中预制件，creat，取个名字，存到Animations文件夹下</li>
<li>把素材拖进去<blockquote>
<p>动画样本的默认大小为60，是在Animation窗口内的动画属性上方的Samples设置中设定的<br>时间轴在0：00 - 1：00 之间有60条垂线。因此，动画会以每秒60帧的速度运行，这意味着Unity每秒将精灵渲染60次<br>若是找不到Samples：在Animation窗口的右上角的X号下面的三个圆点，点击，选择Show Samples Rate。为了动画的流畅，请随意修改Samples<br>Unity动画提供反转的功能（Add Property&gt;Sprite Render&gt;Filp X可以对动画素材左右横转，其他类似）<br><br></br></p>
</blockquote>
</li>
</ul>
<h1 id="用混合树管理动画剪辑"><a href="#用混合树管理动画剪辑" class="headerlink" title="用混合树管理动画剪辑"></a>用混合树管理动画剪辑</h1><p>使上面不同的动画剪辑与Robot不同的状态一一对应，这个工作由Animation Controller执行。</p>
<blockquote>
<p>怎样使用Animation Controller？</p>
</blockquote>
<ul>
<li>首先，有两种方法打开。第一种，因为我们已经创建了控制器Robot，只不过还没开始用，点击（Animations&gt;Ruby），open；第二种，Window&gt;Animation&gt;Animator(需选中预制件，才能看到)</li>
<li>对于Animator窗口，在左侧空间，有两个分页，一个是Layers（层次，一般用来管理3D动画，可以用于角色的不同部分），另一个是Parameters（参数与动画脚本进行挂接，用程序来控制参数，参数再通过控制器Animation Controller决定具体播放哪一段动画；一会我们就使用不同的参数来控制动画剪辑的状态的转化）</li>
</ul>
<h2 id="动画状态机"><a href="#动画状态机" class="headerlink" title="动画状态机"></a>动画状态机</h2><ul>
<li>右键点击动画剪辑，Make Transiton，多出来一条线，指向谁，与谁进行连接</li>
</ul>
<h2 id="混合树（这时比动画状态机更简单的方式，用参数来混合多段动画）"><a href="#混合树（这时比动画状态机更简单的方式，用参数来混合多段动画）" class="headerlink" title="混合树（这时比动画状态机更简单的方式，用参数来混合多段动画）"></a>混合树（这时比动画状态机更简单的方式，用参数来混合多段动画）</h2><ul>
<li>回到Animator窗口，把窗口右侧的动画剪辑State上删掉</li>
<li>调出混合树来专门管理动画剪辑的播放。新建一个混合树：右键，Create State（创建状态）&gt;From New Blend Tree</li>
<li>双击进入Blend Tree，接下来的操作都在Blend Tree里进行。然后要用到参数面板，左侧是搜索框，用来搜索不同的参数，右侧+号是下拉列表，用于新建不同数据类型的参数</li>
<li>（右侧是用鼠标中键来移动的：点击鼠标中键，拖拽）</li>
<li>把原来的参数的delete，新建立2个（和教程上保持一致，命名为Move X,Move Y）</li>
<li>选中Blend Tree，右侧Inspector里的Blend Type是选择类型。因为是实例，选择简单的2D Simple Directional，参数Parameters选中Move X和Move Y</li>
<li>这时Blend Tree 已经有Move X 和Move Y了，它的默认值是0到1</li>
<li>Inspector&gt;Motion(添加参数与动画剪辑之间关联的)，点击+号，Add Motion Field，有几个不同的动画剪辑，添加几个</li>
<li>Motion 挂接动画剪辑就行了</li>
<li>对Pos X，Pos Y两个参数的值进行配置，根据它们进行挂接（tip:后面的钟是播放速度，第四个是镜像）<blockquote>
<p>这时，Blend Tree设置好了<br><br></br></p>
</blockquote>
</li>
</ul>
<h2 id="将参数发送到Animator-Controller"><a href="#将参数发送到Animator-Controller" class="headerlink" title="将参数发送到Animator Controller"></a>将参数发送到Animator Controller</h2><blockquote>
<p>脚本里面设置好移动方向，计时器里设置方向的转化，同时也会进行动画剪辑的设定，根据方向控制播放哪一个的动画剪辑</p>
</blockquote>
<ul>
<li>首先获取Animator组件</li>
<li>组件里的Controller就可以对代码进行控制了</li>
<li>实际还是通过Animator这个组件的对象来进行参数的传递的</li>
</ul>
<p>以下是EnemyController2完整的代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">public class EnemyController2 : MonoBehaviour &#123;</span><br><span class="line">    //代表移动速度（实际上是每次刷新时移动的距离）</span><br><span class="line">    public float speed;</span><br><span class="line">    //是否垂直移动，true按y轴移动，false按x轴移动</span><br><span class="line">    public bool vertical;</span><br><span class="line"></span><br><span class="line">    //声明刚体对象</span><br><span class="line">    //rigidbody2D先前我们已经用过了，如果不希望rigidbody2D被覆盖</span><br><span class="line">    //这里可以取比如rigidbody2d这种不一样的名字</span><br><span class="line">    Rigidbody2D rigidbody2d;</span><br><span class="line"></span><br><span class="line">    //朝一个方向移动的总时间</span><br><span class="line">    public float changeTime = 3.0f;</span><br><span class="line"></span><br><span class="line">    //计时器</span><br><span class="line">    float timer;</span><br><span class="line">    //方向</span><br><span class="line">    int direction = 1;</span><br><span class="line">    // Start is called before the first frame update</span><br><span class="line"></span><br><span class="line">    //在字段里面声明一个Animator,动画管理者组件</span><br><span class="line">    Animator animator;</span><br><span class="line">    void Start() &#123;</span><br><span class="line">        //通过当前这个代码组件，获取到这个代码组件所在的游戏对象</span><br><span class="line">        //再通过游戏对象，获取到刚体组件</span><br><span class="line">        rigidbody2d = GetComponent&lt;Rigidbody2D&gt;();</span><br><span class="line"></span><br><span class="line">        //游戏对象一般都是通过Start获取</span><br><span class="line">        rigidbody2d = GetComponent&lt;Rigidbody2D&gt;();</span><br><span class="line">        //计时器也要给它设置好</span><br><span class="line">        timer = changeTime;</span><br><span class="line">        //把Animator实例化，拿到脚本组件所挂接的游戏对象的Animator组件</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //Update本来是每帧来调用，但是和FixedUpdate结合使用，它又是固定的</span><br><span class="line">    void Update() &#123;</span><br><span class="line">        //每次减少</span><br><span class="line">        //但是每秒减少还是一样的</span><br><span class="line">        timer -= Time.deltaTime;</span><br><span class="line">        //如果timer到0，重置</span><br><span class="line">        if (timer &lt; 0) &#123;</span><br><span class="line">            //方向取反</span><br><span class="line">            direction = -direction;</span><br><span class="line">            //时间重置</span><br><span class="line">            timer = changeTime;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    //若是希望移动非常稳定的话，用FixedUpdate</span><br><span class="line">    private void FixedUpdate() &#123;</span><br><span class="line">        //获取当前游戏对象所在的位置</span><br><span class="line">        Vector2 position = rigidbody2d.position;</span><br><span class="line"></span><br><span class="line">        //纵向移动，沿y轴移动</span><br><span class="line">        //加不加Time.deltaTime都可以</span><br><span class="line">        if (vertical) &#123;</span><br><span class="line">            position.y = position.y + Time.deltaTime * speed*direction;</span><br><span class="line">            animator.SetFloat(&quot;Move X&quot;, 0);</span><br><span class="line">            animator.SetFloat(&quot;Move Y&quot;, direction);</span><br><span class="line">        &#125;</span><br><span class="line">        //否则，沿x轴移动</span><br><span class="line">        else &#123;</span><br><span class="line">            position.x = position.x + Time.deltaTime * speed*direction;</span><br><span class="line">            animator.SetFloat(&quot;Move X&quot;, direction);</span><br><span class="line">            animator.SetFloat(&quot;Move Y&quot;, 0);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        //和直接赋值的效果是一样的，但是这个更严谨些</span><br><span class="line">        rigidbody2d.MovePosition(position);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //刚体碰撞的方法</span><br><span class="line">    //在这个方法中，添加对玩家伤害的逻辑</span><br><span class="line">    private void OnCollisionEnter2D(Collision2D other) &#123;</span><br><span class="line">        //获取和敌人碰撞的玩家角色</span><br><span class="line">        //先获取玩家控制器脚本</span><br><span class="line">        //这个类的设置不能直接GetComponent</span><br><span class="line">        //要先获得gameObject</span><br><span class="line">        //这个是类设定的规则，记住这个方式来使用</span><br><span class="line">        RubyController rubyController = other.gameObject.GetComponent&lt;RubyController&gt;();</span><br><span class="line"></span><br><span class="line">        //如果不为空，直接让它减血</span><br><span class="line">        if (rubyController != null) &#123;</span><br><span class="line">            //玩家角色掉血</span><br><span class="line">            rubyController.ChangeHealth(-1);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>Enemy Controller2&gt;Change Time 修改速度<br>Hierarchy&gt;Robot&gt;Enemy Controller2 勾选Vertical，纵向</p>
</blockquote>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2022/04/25/%E6%B7%BB%E5%8A%A0%E6%95%8C%E4%BA%BA%E4%BC%A4%E5%AE%B3/">
                添加敌人伤害
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2022-04-25</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <blockquote>
<p>若是要实现敌人对角色的伤害，而并非通过触发器的碰撞（Box Collider 2D&gt;Is Trigger，若是触发器会导致玩家像鬼魂一样穿过敌人)</p>
</blockquote>
<blockquote>
<p>若是要敌人<strong>碰撞体</strong>为实心，并且与角色实际碰撞，使用OnCollisionEnter2D(刚体与某个对象碰撞时调用的函数)，类似于伤害区的OnTriggerEnter2D</p>
</blockquote>
<blockquote>
<p>下面是EnemyController2完整的代码</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">public class EnemyController2 : MonoBehaviour &#123;</span><br><span class="line">    //代表移动速度（实际上是每次刷新时移动的距离）</span><br><span class="line">    public float speed;</span><br><span class="line">    //是否垂直移动，true按y轴移动，false按x轴移动</span><br><span class="line">    public bool vertical;</span><br><span class="line"></span><br><span class="line">    //声明刚体对象</span><br><span class="line">    //rigidbody2D先前我们已经用过了，如果不希望rigidbody2D被覆盖</span><br><span class="line">    //这里可以取比如rigidbody2d这种不一样的名字</span><br><span class="line">    Rigidbody2D rigidbody2d;</span><br><span class="line"></span><br><span class="line">    //朝一个方向移动的总时间</span><br><span class="line">    public float changeTime = 3.0f;</span><br><span class="line"></span><br><span class="line">    //计时器</span><br><span class="line">    float timer;</span><br><span class="line">    //方向</span><br><span class="line">    int direction = 1;</span><br><span class="line">    // Start is called before the first frame update</span><br><span class="line">    void Start() &#123;</span><br><span class="line">        //通过当前这个代码组件，获取到这个代码组件所在的游戏对象</span><br><span class="line">        //再通过游戏对象，获取到刚体组件</span><br><span class="line">        rigidbody2d = GetComponent&lt;Rigidbody2D&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //Update本来是每帧来调用，但是和FixedUpdate结合使用，它又是固定的</span><br><span class="line">    void Update() &#123;</span><br><span class="line">        //每次减少</span><br><span class="line">        //但是每秒减少还是一样的</span><br><span class="line">        timer -= Time.deltaTime;</span><br><span class="line">        //如果timer到0，重置</span><br><span class="line">        if (timer &lt; 0) &#123;</span><br><span class="line">            //方向取反</span><br><span class="line">            direction = -direction;</span><br><span class="line">            //时间重置</span><br><span class="line">            timer = changeTime;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    //若是希望移动非常稳定的话，用FixedUpdate</span><br><span class="line">    private void FixedUpdate() &#123;</span><br><span class="line">        //获取当前游戏对象所在的位置</span><br><span class="line">        Vector2 position = rigidbody2d.position;</span><br><span class="line"></span><br><span class="line">        //纵向移动，沿y轴移动</span><br><span class="line">        //加不加Time.deltaTime都可以</span><br><span class="line">        if (vertical) &#123;</span><br><span class="line">            position.y = position.y + Time.deltaTime * speed*direction;</span><br><span class="line">        &#125;</span><br><span class="line">        //否则，沿x轴移动</span><br><span class="line">        else &#123;</span><br><span class="line">            position.x = position.x + Time.deltaTime * speed*direction;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        //和直接赋值的效果是一样的，但是这个更严谨些</span><br><span class="line">        rigidbody2d.MovePosition(position);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //刚体碰撞的方法</span><br><span class="line">    //在这个方法中，添加对玩家伤害的逻辑</span><br><span class="line">    private void OnCollisionEnter2D(Collision2D other) &#123;</span><br><span class="line">        //获取和敌人碰撞的玩家角色</span><br><span class="line">        //先获取玩家控制器脚本</span><br><span class="line">        //这个类的设置不能直接GetComponent</span><br><span class="line">        //要先获得gameObject</span><br><span class="line">        //这个是类设定的规则，记住这个方式来使用</span><br><span class="line">        RubyController rubyController = other.gameObject.GetComponent&lt;RubyController&gt;();</span><br><span class="line"></span><br><span class="line">        //如果不为空，直接让它减血</span><br><span class="line">        if (rubyController != null) &#123;</span><br><span class="line">            //玩家角色掉血</span><br><span class="line">            rubyController.ChangeHealth(-1);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="关于Collision2D"><a href="#关于Collision2D" class="headerlink" title="关于Collision2D"></a>关于Collision2D</h1><p>该类对象是回调函数返回的碰撞细节。用来描述碰撞本身。<br>是包含碰撞信息的一个类</p>
<p>可以通过碰撞细节事件函数（回调函数）来编写两个刚体碰撞后的游戏逻辑</p>
<h2 id="碰撞回调函数有三个"><a href="#碰撞回调函数有三个" class="headerlink" title="碰撞回调函数有三个"></a>碰撞回调函数有三个</h2><ul>
<li>OnCollisionEnter2D(MonoBehaviour.OnCollisionEnter2D)</li>
<li>OnCollisionStay2D(OnCollisionEnter2D.OnCollisionStay2D)</li>
<li>OnCollisionExit2D(OnCollisionEnter2D.OnCollisionExity2D)</li>
</ul>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2022/04/24/%E6%95%8C%E4%BA%BA%E7%A7%BB%E5%8A%A8%E6%96%B9%E5%BC%8F/">
                敌人移动方式
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2022-04-24</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <blockquote>
<p>来设计一个敌人，并设计敌人的移动方式吧。下面是敌人移动方式的代码</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">public class EnemyController : MonoBehaviour &#123;</span><br><span class="line">    //设定移动变量速度</span><br><span class="line">    public float speed = 0.1f;</span><br><span class="line">    //声明一个2D刚体对象</span><br><span class="line">    Rigidbody2D rigidbody2D;</span><br><span class="line">    //声明Vector2对象来存放敌人当前位置</span><br><span class="line">    Vector2 position;</span><br><span class="line">    //声明一个初始y坐标变量</span><br><span class="line">    float initY;</span><br><span class="line">    //声明一个移动方向的变量</span><br><span class="line">    float direction;</span><br><span class="line">    //存放移动距离的变量，设置为公有，开放在unity中的访问</span><br><span class="line">    public float distance = 4;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // Start is called before the first frame update</span><br><span class="line">    void Start() &#123; </span><br><span class="line">        //获取这些对象或变量在游戏开始时的值</span><br><span class="line">        rigidbody2D = GetComponent&lt;Rigidbody2D&gt;();</span><br><span class="line">        //获取起始位置</span><br><span class="line">        position = transform.position;</span><br><span class="line">        //获取起始位置，最终还是为了获取y坐标</span><br><span class="line">        initY = position.y;</span><br><span class="line">        //设定初始移动方向</span><br><span class="line">        //我们设定direction要么是1.0，要么是-1.0</span><br><span class="line">        //-1.0代表折返</span><br><span class="line">        direction = 1.0f;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void FixedUpdate() &#123;</span><br><span class="line">        //通过刚体移动的方法调用，放入fixupdate方法中，0.02秒执行一次</span><br><span class="line">        MovePositon();//这是我们自定义的一个方法</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //自定义在Y轴折返移动的算法</span><br><span class="line">    private void MovePositon() &#123;</span><br><span class="line">        //每次满足其中的一种或两种条件</span><br><span class="line">        if(position.y-initY&lt;distance&amp;&amp;direction&gt;0)v&#123;</span><br><span class="line">            position.y += speed;</span><br><span class="line">        &#125;</span><br><span class="line">        if (position.y - initY &gt;= distance &amp;&amp; direction &gt; 0) &#123;</span><br><span class="line">            direction = -0.1f;</span><br><span class="line">        &#125;</span><br><span class="line">        if (position.y - initY &gt; 0 &amp;&amp; direction &lt; 0) &#123;</span><br><span class="line">            position.y -= speed;</span><br><span class="line">        &#125;</span><br><span class="line">        if (position.y - initY &lt;= distance &amp;&amp; direction &gt; 0) &#123;</span><br><span class="line">            direction = 0.1f;</span><br><span class="line">        &#125;</span><br><span class="line">        //通过刚体系统移动游戏对象</span><br><span class="line">        rigidbody2D.position = position;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>把上述的移动方式屏蔽（取消脚本勾选），来看另一种方法吧（更完善）</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">public class EnemyController2 : MonoBehaviour &#123;</span><br><span class="line">    //代表移动速度（实际上是每次刷新时移动的距离）</span><br><span class="line">    public float speed;</span><br><span class="line">    //是否垂直移动，true按y轴移动，false按x轴移动</span><br><span class="line">    public bool vertical;</span><br><span class="line"></span><br><span class="line">    //声明刚体对象</span><br><span class="line">    //rigidbody2D先前我们已经用过了，如果不希望rigidbody2D被覆盖</span><br><span class="line">    //这里可以取比如rigidbody2d这种不一样的名字</span><br><span class="line">    Rigidbody2D rigidbody2d;</span><br><span class="line"></span><br><span class="line">    //朝一个方向移动的总时间</span><br><span class="line">    public float changeTime = 3.0f;</span><br><span class="line"></span><br><span class="line">    //计时器</span><br><span class="line">    float timer;</span><br><span class="line">    //方向</span><br><span class="line">    int direction = 1;</span><br><span class="line">    // Start is called before the first frame update</span><br><span class="line">    void Start() &#123;</span><br><span class="line">        //通过当前这个代码组件，获取到这个代码组件所在的游戏对象</span><br><span class="line">        //再通过游戏对象，获取到刚体组件</span><br><span class="line">        rigidbody2d = GetComponent&lt;Rigidbody2D&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //Update本来是每帧来调用，但是和FixedUpdate结合使用，它又是固定的</span><br><span class="line">    void Update() &#123;</span><br><span class="line">        //每次减少</span><br><span class="line">        //但是每秒减少还是一样的</span><br><span class="line">        timer -= Time.deltaTime;</span><br><span class="line">        //如果timer到0，重置</span><br><span class="line">        if (timer &lt; 0) &#123;</span><br><span class="line">            //方向取反</span><br><span class="line">            direction = -direction;</span><br><span class="line">            //时间重置</span><br><span class="line">            timer = changeTime;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //若是希望移动非常稳定的话，用FixedUpdate</span><br><span class="line">    private void FixedUpdate() &#123;</span><br><span class="line">        //获取当前游戏对象所在的位置</span><br><span class="line">        Vector2 position = rigidbody2d.position;</span><br><span class="line"></span><br><span class="line">        //纵向移动，沿y轴移动</span><br><span class="line">        //加不加Time.deltaTime都可以</span><br><span class="line">        if (vertical) &#123;</span><br><span class="line">            position.y = position.y + Time.deltaTime * speed*direction;</span><br><span class="line">        &#125;</span><br><span class="line">        //否则，沿x轴移动</span><br><span class="line">        else &#123;</span><br><span class="line">            position.x = position.x + Time.deltaTime * speed*direction;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        //和直接赋值的效果是一样的，但是这个更严谨些</span><br><span class="line">        rigidbody2d.MovePosition(position);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2022/04/23/%E5%B9%B3%E9%93%BA%E6%8E%89%E8%A1%80%E5%8C%BA%E5%9F%9F/">
                平铺掉血区域
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2022-04-23</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <p>假设我们已做好了关于掉血区域的预制件，要做一片连续的掉血区域。把预制件一个一个进行拼接，就显得有点呆。</p>
<blockquote>
<p>Unity自带平铺的功能<br>下面我们来看看如何进行使用</p>
</blockquote>
<p>Damageable是我已做好的掉血区域的预制件。</p>
<p>让我们对它的属性进行一个更改</p>
<ul>
<li>1.首先，先把游戏对象的缩放进行取消。把Transform中的Scale中的x，y，z都设置为1</li>
<li>2.Sprite Renderer&gt;Draw Mode(可选Simple，Slice,Tiled)，把原来的Simple改成Tiled（平铺）</li>
<li>3.在操作2后，我们能看到出现了一个警告“Sprite Tilling might not appear correctly because the Sprite used is not generated with Full Rect or Sprite Mode is set to Polygon mode.To fix this,change the Mesh Type in the Sprite’s import setting to Full Rect and Sprite Mode is either Single or Multiple。”</li>
<li>4.打开对应的素材，单击它。在Sprite Mode中的Mesh Type，把Tight改成Full Rect</li>
<li>5.设置往之后，apply（应用&#x2F;保存）</li>
<li>6.这时回到Scence，再拉去选框（矩形工具），就是平铺的效果了。当然，在Scale也能进行缩放</li>
<li>7.但是要注意，在设置完平铺的效果后，碰撞区域依然的原来的大小，这是不对的。在Box Collider 2D（碰撞体）里面，勾选Auto Tiling（自动平铺）</li>
</ul>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2022/04/23/%E8%AE%BE%E7%BD%AE%E6%97%A0%E6%95%8C%E6%97%B6%E9%97%B4/">
                设置无敌时间
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2022-04-23</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <blockquote>
<p>对角色设置无敌时间</p>
</blockquote>
<ul>
<li>Part 1<br>设置无敌时间和无敌变量</li>
<li>Part 2<br>判断是否处于无敌状态</li>
<li>Part 3<br>对于是否处于无敌状态相对应的操作</li>
</ul>
<p><br></br></p>
<p>下面是完整的代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">public class RubyController : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">    //设置玩家间隔无敌时间</span><br><span class="line">    public float timeInvincible = 2.0f;</span><br><span class="line">    //设置是否无敌的变量</span><br><span class="line">    bool isInvincible;</span><br><span class="line">    //定义变量，进行无敌时间的计时，无敌时间计时器</span><br><span class="line">    float invincibleTimer;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    //设置最大生命值（生命上限）</span><br><span class="line">    public int maxHealth = 5;</span><br><span class="line">    //设置当前生命值的属性health</span><br><span class="line"></span><br><span class="line">    //c#中支持面向对象程序设计中的封装概念，对数据成员的保护</span><br><span class="line">    //数据成员变量，默认一般都应该设置为私有，只能通过对当前类的方法或属性进行访问</span><br><span class="line">    //属性类似于特殊的函数结构，它get是一个关键字</span><br><span class="line">    //get是获取当前属性所绑定的字段的值</span><br><span class="line">    //属性相当于一个盒子，字段是在盒子里的某件东西</span><br><span class="line">    //属性限制了字段的访问规则，比如只能读或写</span><br><span class="line">    //或者读写的时候满足某种需求，才能往外进行操作</span><br><span class="line">    //相当于把它包装起来，这就称为封装</span><br><span class="line">    //属性是公有的，可以通过取值器get、赋值器set设定对应字段的访问规则，满足规则才能进行访问</span><br><span class="line"></span><br><span class="line">    public int health &#123; </span><br><span class="line">        get &#123; return currentHealth; &#125;</span><br><span class="line">        //set &#123; currentHealth = value; &#125;//可赋值</span><br><span class="line">    &#125;</span><br><span class="line">    int currentHealth;</span><br><span class="line"></span><br><span class="line">    //声明刚体对象</span><br><span class="line">    Rigidbody2D rigidbody2D;</span><br><span class="line">    //获取用户输入</span><br><span class="line">    float horizontal;</span><br><span class="line">    float vertical;</span><br><span class="line"></span><br><span class="line">    //将速度暴露出来，使其可调</span><br><span class="line">    public float speed = 0.1f;</span><br><span class="line"></span><br><span class="line">    private void Start() &#123;</span><br><span class="line">        //获取当前游戏对象的刚体组件</span><br><span class="line">        rigidbody2D = GetComponent&lt;Rigidbody2D&gt;();</span><br><span class="line">        //游戏刚开始，玩家满血</span><br><span class="line">        currentHealth = maxHealth;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // Update is called once per frame</span><br><span class="line">    //每帧调用一次Update</span><br><span class="line">    //让游戏对象每帧右移0.1</span><br><span class="line">    void Update() &#123;</span><br><span class="line">        //获取水平输入，按向左，会获得-1.0f；按向右，会获得1.0f</span><br><span class="line">        horizontal = Input.GetAxis(&quot;Horizontal&quot;);</span><br><span class="line">        //获取垂直输入，按向下，会获得-1.0f；按向上，会获得1.0f</span><br><span class="line">        vertical = Input.GetAxis(&quot;Vertical&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        //判断是否处于无敌状态，来进行计时器的倒计时</span><br><span class="line">        if (isInvincible) &#123;</span><br><span class="line">            //每次Update减去一帧消耗的时间</span><br><span class="line">            invincibleTimer = invincibleTimer - Time.deltaTime;</span><br><span class="line">            if (invincibleTimer &lt; 0) &#123;</span><br><span class="line">                isInvincible = false;//无敌时间小于0了，让它不无敌了</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //固定时间间隔执行的更新方法</span><br><span class="line">    private void FixedUpdate() &#123;</span><br><span class="line">        //获取当前对象位置</span><br><span class="line">        Vector2 position = transform.position;</span><br><span class="line">        //更改位置</span><br><span class="line">        position.x = position.x + 0.1f * horizontal;</span><br><span class="line">        position.y = position.y + 0.1f * vertical;</span><br><span class="line">        //新位置给游戏参数</span><br><span class="line">        rigidbody2D.position = position;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //不是系统函数，自定义来更改生命值的</span><br><span class="line">    public void ChangeHealth(int amount) &#123;</span><br><span class="line">        //假设玩家受伤害的时间间隔是2秒</span><br><span class="line">        //不管是什么样的伤害，只要amount小于0，就判断是不是无敌</span><br><span class="line">        if (amount &lt; 0) &#123;</span><br><span class="line">            //判断当前是否处于无敌状态</span><br><span class="line">            if (isInvincible) &#123;</span><br><span class="line">                //无敌不伤血，跳出无敌状态</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        //当不是无敌状态时，会执行下面的代码</span><br><span class="line">        //重置无敌状态为真</span><br><span class="line">        isInvincible = true;</span><br><span class="line">        //设置无敌时间</span><br><span class="line">        invincibleTimer = timeInvincible;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        //系统函数Clamp，用于限制取值范围的函数</span><br><span class="line">        //0~最大生命值</span><br><span class="line">        currentHealth = Mathf.Clamp(currentHealth + amount, 0, maxHealth);</span><br><span class="line">        //在控制台输出生命信息</span><br><span class="line">        Debug.Log(&quot;当前生命值：&quot; + currentHealth + &quot;/&quot; + maxHealth);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
        </div>
    

</div>
            
        </section>
    </div>
</div>



    <div class="row">
        <div class="col-sm-12">
            <div class="wrap-pagination">
                <a class="" href="/">
                    <i class="fa fa-chevron-left" aria-hidden="true"></i>
                </a>
                <a class="" href="/page/3/">
                    <i class="fa fa-chevron-right" aria-hidden="true"></i>
                </a>
            </div>
        </div>
    </div>




</div>

<!-- Footer -->
<div class="push"></div>

<footer class="footer-content">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 footer-about">
                <h2>About</h2>
                <p>
                    This theme was developed by <a target="_blank" rel="noopener" href="https://github.com/klugjo">Jonathan Klughertz</a>. The source code is available on Github. Create Websites. Make Magic.
                </p>
            </div>
            
    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 recent-posts">
        <h2>Recent Posts</h2>
        <ul>
            
            <li>
                <a class="footer-post" href="/2022/05/05/%E9%9F%B3%E9%A2%91/">音频</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2022/05/04/TextMeshPro%E6%AD%A3%E5%B8%B8%E6%98%BE%E7%A4%BA%E4%B8%AD%E6%96%87%E4%B8%8E%E7%BF%BB%E9%A1%B5/">TextMeshPro正常显示中文与翻页</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2022/05/04/%E4%BB%A3%E7%A0%81%E6%8E%A7%E5%88%B6%E5%AF%B9%E8%AF%9D%E6%A1%86/">代码控制对话框</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2022/05/03/%E5%AF%B9%E8%AF%9D%E5%B0%84%E7%BA%BF%E6%8A%95%E5%B0%84/">对话射线投射</a>
            </li>
            
        </ul>
    </div>



            
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <ul class="list-inline footer-social-icons">
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://github.com/klugjo/hexo-theme-alpha-dust">
                            <span class="footer-icon-container">
                                <i class="fa fa-github"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://twitter.com/?lang=en">
                            <span class="footer-icon-container">
                                <i class="fa fa-twitter"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://www.facebook.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-facebook"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://www.instagram.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-instagram"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://dribbble.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-dribbble"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://telegram.org/">
                            <span class="footer-icon-container">
                                <i class="fa fa-telegram"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://www.behance.net/">
                            <span class="footer-icon-container">
                                <i class="fa fa-behance"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://500px.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-500px"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="mailto:test@example.com">
                            <span class="footer-icon-container">
                                <i class="fa fa-envelope-o"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="\#">
                            <span class="footer-icon-container">
                                <i class="fa fa-rss"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="footer-copyright">
                    @Untitled. All right reserved | Design & Hexo <a target="_blank" rel="noopener" href="http://www.codeblocq.com/">Jonathan Klughertz</a>
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- After footer scripts -->

<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Tween Max -->
<script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TweenMax.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JavaScript -->

<script src="/js/main.js"></script>


<!-- Disqus Comments -->



</body>

</html>